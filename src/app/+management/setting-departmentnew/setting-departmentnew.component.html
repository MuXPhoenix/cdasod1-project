<div id="content">
  <div class="row">
    <sa-big-breadcrumbs [items]="['人事管理', '部门设置']" icon="pencil-square-o" ></sa-big-breadcrumbs>
  </div>

  <sa-widgets-grid>
    <div class="row">
      <article class="col-sm-12 ">
        <sa-widget [editbutton]="false" [deletebutton]="false" [colorbutton]="false">
          <header>
            <span class="widget-icon"> <i class="fa fa-table"></i> </span>
            <h2>部门设置</h2>
          </header>

          <div>
            <div class="widget-body no-padding" >
              <div  class="row">
                <article  class="col-sm-12">
                  <div class="navbar navbar-default">
                    <div class="collapse navbar-collapse">

                      <form  class="navbar-form navbar-left ng-pristine ng-valid ng-touched" novalidate="" role="search" >
                        <div class="form-group">
                          <a class="btn btn-success btn-sm"  data-toggle="modal" data-target="#myModal">
                            <span class="glyphicon glyphicon-plus"></span>添加</a>
                        </div>
                        <div class="form-group">
                          <a class="btn btn-warning btn-sm"  data-toggle="modal" data-target="#myModal">
                            <span class="glyphicon glyphicon-pencil"></span>修改</a>
                        </div>
                        <div class="form-group">
                          <a class="btn btn-success btn-sm"  >
                            <span class="glyphicon glyphicon-zoom-in"></span>详情</a>
                        </div>
                        <div class="form-group padding-left-10">
                          <input  class="form-control ng-pristine ng-valid ng-touched" maxlength="15" name="keyword" placeholder="请输入搜索内容" type="text">
                        </div>
                        <button class="btn btn-default" type="submit">
                          <i  class="glyphicon glyphicon-search"></i>
                          搜索
                        </button>
                      </form>
                    </div>
                  </div>
                </article>
              </div>

              <div class="pt">
                <article class="form-group col col-xs-4">
                  <sa-widget class="jarviswidget well" [colorbutton]="false" [editbutton]="false" [togglebutton]="false"
                             [deletebutton]="false" [fullscreenbutton]="false" [custombutton]="false" [sortable]="false">
                    <div>
                      <div class="widget-body no-padding">
                        <alert type="info" class="no-margin"  >
                          <i class="fa-fw fa fa-th-large"></i>
                          部门分类
                        </alert>



                      </div>
                    </div>
                  </sa-widget>
                </article>
                <article class="form-group col col-xs-8">
                  <sa-widget class="jarviswidget well" [colorbutton]="false" [editbutton]="false" [togglebutton]="false"
                             [deletebutton]="false" [fullscreenbutton]="false" [custombutton]="false" [sortable]="false">
                    <div>
                      <div class="widget-body no-padding">
                        <alert type="info" class="no-margin" >
                          <i class="fa-fw fa fa-spoon"></i>
                          部分详情
                        </alert>

                        <div style="padding:0;">
                          <div style="padding: 0;z-index: 2;" class="table-responsive">
                            <table class="table table-striped  table-hover smart-form">
                              <thead>
                              <tr >
                                <td><label class="checkbox">
                                  <input type="checkbox" name="checkbox-inline" >
                                  <i></i>
                                </label>
                                </td>
                                <th>序号</th>
                                <th>名称</th>
                                <th>类别代码</th>
                                <th>类别名称</th>
                                <th>说明</th>
                              </tr>
                              </thead>
                              <tbody>
                              <tr class="">
                                <td>
                                  <label class="checkbox">
                                    <input type="checkbox" >
                                    <i></i>
                                  </label>
                                </td>
                                <td>1</td>
                                <td>四川矿业有限公司</td>
                                <td>2155</td>
                                <td>分隔符</td>
                                <td>囧囧飞洒街坊邻居撒娇给付对价会计法看见过复健科该矿该矿</td>
                              </tr>
                              <tr class="">
                                <td>
                                  <label class="checkbox">
                                    <input type="checkbox" >
                                    <i></i>
                                  </label>
                                </td>
                                <td>1</td>
                                <td>四川矿业有限公司</td>
                                <td>2155</td>
                                <td>分隔符</td>
                                <td>囧囧飞洒街坊邻居撒娇给付对价会计法看见过复健科该矿该矿</td>
                              </tr>
                              <tr class="table-color">
                                <td>
                                  <label class="checkbox">
                                    <input type="checkbox" >
                                    <i></i>
                                  </label>
                                </td>
                                <td>1</td>
                                <td>四川矿业有限公司</td>
                                <td>2155</td>
                                <td>分隔符</td>
                                <td>囧囧飞洒街坊邻居撒娇给付对价会计法看见过复健科该矿该矿</td>
                              </tr>


                              </tbody>
                            </table>

                          </div>
                        </div>




                        <!-- 底部-（分页部分）-->
                        <div class="dt-toolbar">
                          <div class="col-xs-12 col-sm-6">
                            <button class="btn btn-default">
                              <i class="fa fa-trash-o fa-lg"></i>
                              删除所选
                            </button>
                          </div>
                          <div class="hidden-xs right">
                            <ul class="pagination pagination-sm">
                              <li *ngFor="let p of categoryList?.page" class="{{p.class}}">
                                <a (click)="pagination(p.value)" *ngIf="p.method=='method'">{{p.text}}</a>
                                <a *ngIf="p.method==''">{{p.text}}</a>
                              </li>
                            </ul>
                          </div>
                        </div>

                      </div>
                    </div>
                  </sa-widget>
                  <!-- end widget -->
                </article>
              </div>



            </div>





          </div>

        </sa-widget>
      </article>
    </div>
  </sa-widgets-grid>



  <sa-widget [editbutton]="false" [fullscreenbutton]="false" [custombutton]="false" [sortable]="false">
    <header>
      <ul class="nav nav-tabs pull-left in">
        <li [class.active]="state.tabs.demo4=='AA'" class="active">
          <a (click)="state.tabs.demo4 = 'AA'">部门设置</a>
        </li>
      </ul>
    </header>
    <div>
      <div class="widget-body">
        <tabset>
          <tab [active]="state.tabs.demo4 == 'AA'">
            <tabset class="padding-10">
              <tab [active]="state.tabs.demo4 == 'AA'">
                <div class="row">
                  <article class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <sa-widget class="jarviswidget well" [colorbutton]="false" [editbutton]="false" [togglebutton]="false"
                               [deletebutton]="false" [fullscreenbutton]="false" [custombutton]="false" [sortable]="false">
                      <div>
                        <div class="widget-body no-padding">
                          <alert type="info" class="no-margin" >
                            <i class="fa-fw fa fa-spoon"></i>
                            部门设置
                          </alert>
                          <div  class="row">
                            <article  class="col-sm-12">
                              <div class="navbar navbar-default">
                                <div class="collapse navbar-collapse">

                                  <form  class="navbar-form navbar-left ng-pristine ng-valid ng-touched" novalidate="" role="search" >
                                    <div class="form-group">
                                      <a class="btn btn-success btn-sm"  data-toggle="modal" data-target="#myModal">
                                        <span class="glyphicon glyphicon-plus"></span>添加部门</a>
                                    </div>
                                    <div class="form-group padding-left-10">
                                      <input  class="form-control ng-pristine ng-valid ng-touched" maxlength="15" name="keyword" [(ngModel)]="keyword" placeholder="请输入搜索内容" type="text">
                                    </div>
                                    <button class="btn btn-default" type="button" (click)="getDepartmentList(1)">
                                      <i class="glyphicon glyphicon-search"></i>
                                      搜索
                                    </button>
                                  </form>
                                </div>
                              </div>
                            </article>
                          </div>
                          <div class="table-responsive">
                            <table class="table table-hover table-bordered dataTable">
                              <thead>
                              <tr>
                                <th>部门名称</th>
                                <th>部门编号</th>
                                <th>上级部门</th>
                                <th>部门负责人</th>
                                <th>创建日期</th>
                                <th>部门属性 </th>
                                <th>部门电话 </th>
                                <th>部门传真 </th>
                                <th>部门状态 </th>
                                <th>操作</th>
                              </tr>
                              </thead>
                              <tbody>
                              <tr *ngFor="let d of departmentList.result?.data">
                                <td class="details-control">{{d.department_name}}</td>
                                <!--<td class="details-control"><span class="padding-10"><i class="fa-fw fa  fa-folder-open"></i>{{d.department_name}}</span></td>-->
                                <!--<td class=""><span class="padding-10"><i class="fa-fw fa   fa-file-o"></i>互换</span></td>-->
                                <td>{{d.department_number}}</td>
                                <td>
                                  <span [ngSwitch]="d.upper_department_id">
                                    <span *ngSwitchCase="0">一级部门</span>
                                    <span *ngSwitchDefault>{{d.parent_department}}</span>
                                  </span>
                                </td>
                                <td>{{d.department_incharge}}</td>
                                <td>{{d.created_at}}</td>
                                <td>{{d.department_attribute}}</td>
                                <td>{{d.department_phone}}</td>
                                <td>{{d.department_fax}}</td>
                                <td>
                                  <span [ngSwitch]="d.department_status">
                                    <span *ngSwitchCase="1">正常</span>
                                    <span *ngSwitchCase="2">无效</span>
                                    <span *ngSwitchDefault>未知</span>
                                  </span>
                                </td>
                                <td>
                                  <div>
                                    <a class="btn btn-warning btn-xs" data-toggle="modal" data-target="#myModal" (click)="editDepartment(d.department_id)"><span class="glyphicon glyphicon-pencil"></span>修改</a>
                                    <a class="btn btn-danger btn-xs" (click)="deleteDepartment(d.department_id)"><span class="glyphicon glyphicon-remove"></span>删除</a>
                                  </div>
                                  <!--<div >无权操作</div>-->
                                </td>
                              </tr>
                              </tbody>
                            </table>
                            <!-- 底部-（分页部分）-->
                            <div class="dt-toolbar">
                              <div class="hidden-xs right">
                                <ul class="pagination pagination-sm">
                                  <li *ngFor="let p of departmentList?.page" class="{{p.class}}">
                                    <a (click)="pagination(p.value)" *ngIf="p.method=='method'">{{p.text}}</a>
                                    <a *ngIf="p.method==''">{{p.text}}</a>
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </sa-widget>
                    <!-- end widget -->
                  </article>
                </div>
              </tab>
            </tabset>
          </tab>
        </tabset>
      </div>
    </div>
  </sa-widget>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <!-- 关闭按钮 -->
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
            ×
          </button>
          <!-- 标题 -->
          <h3 *ngIf="department_id == 0" class="modal-title txt-color-blue" data-ng-bind='results.title'><i class="fa-fw fa fa-plus"></i>添加部门</h3>
          <h3 *ngIf="department_id != 0" class="modal-title  glyphicon glyphicon-pencil txt-color-red" data-ng-bind='results.title'>修改部门</h3>
        </div>
        <div class="modal-body">
          <sa-widget [editbutton]="false" [fullscreenbutton]="false" [custombutton]="false" [sortable]="false">
            <header>
              <ul class="nav nav-tabs pull-left in">
                <li [class.active]="state.tabs.demo3=='hr1'" class="active">
                  <a (click)="state.tabs.demo3 = 'hr1'">基本信息</a>
                </li>
                <li [class.active]="state.tabs.demo3=='hr2'" class="active">
                  <a (click)="state.tabs.demo3 = 'hr2'">其他信息</a>
                </li>
              </ul>
            </header>
            <div>
              <div class="widget-body">
                <tabset>
                  <tab [active]="state.tabs.demo3 == 'hr1'">
                    <tabset >
                      <tab [active]="state.tabs.demo3 == 'hr1'">
                        <div class="row">
                          <form class="smart-form " [formGroup]="formModel">
                            <input type="hidden" name="department_id" formControlName="department_id">
                            <fieldset>
                              <div class="form-group col col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <section>
                                  <label class="label">助记码</label>
                                  <label class="input">
                                    <input type="text" name="department_shortcode" formControlName="department_shortcode" placeholder="手工录入或自动生成"  >
                                  </label>
                                </section>
                              </div>
                              <div class="form-group col col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <section>
                                  <label class="label">上级部门</label>
                                  <label class="select">
                                      <select name="upper_department_id" formControlName="upper_department_id" [(ngModel)]="upper_department_id_default">
                                        <option [selected]="department_id == 0" value="0">--请选择--</option>
                                        <option *ngFor="let dd of departmentDefault.result?.department" [selected]="departmentInfo.result?.upper_department_id == dd.department_id" value="{{ dd.department_id }}">{{dd.department_name}}</option>
                                      </select><i></i>
                                  </label>
                                </section>
                              </div>
                              <div class="form-group col col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <section>
                                  <label class="label">部门属性</label>
                                  <label class="input">
                                    <input type="text" placeholder="" name="department_attribute" formControlName="department_attribute">
                                  </label>
                                </section>
                              </div>
                              <div class="form-group col col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <section>
                                  <label class="label txt-color-blue">部门名称</label>
                                  <label class="input">
                                    <input type="text" placeholder="" name="department_name" formControlName="department_name">
                                  </label>
                                </section>
                              </div>
                              <div class="form-group col col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <section>
                                  <label class="label ">负责人</label>
                                  <label class="select">
                                      <select name="department_incharge" formControlName="department_incharge" [(ngModel)]="department_incharge_default">
                                        <option [selected]="department_id == 0" value="0">--请选择--</option>
                                        <option *ngFor="let du of departmentDefault.result?.user" [selected]="departmentInfo.result?.department_incharge == du.id" value="{{ du.id }}">{{du.u_username}}</option>
                                      </select><i></i>
                                  </label>
                                </section>
                              </div>
                              <div class="form-group col col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <section >
                                  <label class="label  ">电话</label>
                                  <label class="input"> <i class="icon-append fa fa-phone"></i>
                                    <input name="department_phone" formControlName="department_phone" placeholder="请输入电话号码" maxlength="12">
                                  </label>
                                </section>
                              </div>
                              <div class="form-group col col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <section>
                                  <label class="label txt-color-blue">部门编号</label>
                                  <label class="input">
                                    <input type="text" name="department_number" formControlName="department_number" placeholder="自动编码" >
                                  </label>
                                </section>
                              </div>
                              <div class="form-group col col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <section>
                                  <label class="label txt-color-blue">传真</label>
                                  <label class="input">
                                    <input type="text" placeholder="" name="department_fax" formControlName="department_fax">
                                  </label>
                                </section>
                              </div>
                              <div class="form-group col col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <section>
                                  <label class="label">备注</label>
                                  <label class="textarea textarea-resizable">
                                    <textarea class="custom-scroll" rows="2" name="department_remark" formControlName="department_remark"></textarea>
                                  </label>
                                </section>
                              </div>

                            </fieldset>
                          </form>
                        </div>
                      </tab>
                    </tabset>
                  </tab>
                  <tab [active]="state.tabs.demo3 == 'hr2'">
                    <tabset >
                      <tab [active]="state.tabs.demo3 == 'hr2'">
                        <div class="row">
                          <form   class="smart-form ">
                            <fieldset>
                              <div class="form-group col col-lg-6 col-md-6 col-sm-6 col-xs-12">
                                <section >
                                  <label class="label ">创建人</label>
                                  <label class="input">
                                    <!--<input name="department_id" formControlName="department_id" disabled="disabled"  type="text" placeholder="用户名">-->
                                  </label>
                                </section>
                              </div>
                            </fieldset>
                          </form>
                        </div>
                      </tab>
                    </tabset>
                  </tab>
                </tabset>
              </div>
            </div>
          </sa-widget>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="onSubmit()">保存</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">返回</button>
        </div>
      </div>
    </div>
  </div>
</div>